<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>PathoTracker huilab</title>
	<meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
	<link rel="icon" href="/statics/assets/img/pku.jpg" type="image/x-icon"/>
	
	<!-- Fonts and icons -->
	<script src="/statics/assets/js/plugin/webfont/webfont.min.js"></script>
	<script>
		WebFont.load({
			google: {"families":["Lato:300,400,700,900"]},
			custom: {"families":["Flaticon", "Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"], urls: ['/statics/assets/css/fonts.min.css']},
			active: function() {
				sessionStorage.fonts = true;
			}
		});
	</script>

	<!-- CSS Files -->
	<link rel="stylesheet" href="/statics/assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="/statics/assets/css/atlantis.min.css">
</head>
<body>
	<div class="wrapper">
		<div class="main-header">
			<!-- Logo Header -->
			<div class="logo-header" data-background-color="blue">
				
				<!--  -->
				<!-- href="index.html" ->改为 href="#"  -->
				<a href="#" class="logo">
					<img src="/statics/assets/img/beidarenmin.jpg" alt="navbar brand" class="navbar-brand" width="40" height="40">
					<img src="/statics/assets/img/pku.jpg" alt="navbar brand" class="navbar-brand" width="40" height="40">
				</a>
				<button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon">
						<i class="icon-menu"></i>
					</span>
				</button>
				<button class="topbar-toggler more"><i class="icon-options-vertical"></i></button>
				<div class="nav-toggle">
					<button class="btn btn-toggle toggle-sidebar">
						<i class="icon-menu"></i>
					</button>
				</div>
			</div>
			<!-- End Logo Header -->

			<!-- Navbar Header -->
			<nav class="navbar navbar-header navbar-expand-lg" data-background-color="blue2">
				
				<div class="container-fluid">
					<span class="text-white fw-bold col-xl-4 ml-auto mr-auto" style="font-size:20px">PathoTracker</span>
				</div>
			</nav>
			<!-- End Navbar -->
		</div>

		<!-- Sidebar -->
		<div class="sidebar sidebar-style-2">			
			<div class="sidebar-wrapper scrollbar scrollbar-inner">
				<div class="sidebar-content">
					<ul class="nav nav-primary">
						<li class="nav-section">
							<span class="sidebar-mini-icon">
								<i class="fa fa-ellipsis-h"></i>
							</span>
							<h4 class="text-section">Components</h4>
						</li>
						<li class="nav-item">
							<a href="/index/">
								<i class="fas fa-desktop"></i>
								<p>Home</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/Tutorial/">
								<i class="fas fa-th-list"></i>
								<p>Tutorial</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/PathoTracker/">
								<i class="fas fa-pen-square"></i>
								<p>PathoTracker</p>
							</a>
						</li>

						<li class="nav-item">
							<a href="/PathoTracker_ST11/">
								<i class="fas fa-pen-square"></i>
								<p>PathoTracker (ST11)</p>
							</a>
							
						</li>

						<li class="nav-item">
							<a href="/species/">
								<i class="fas fa-chart-bar"></i>
								<p>Species detection</p>
							</a>
						</li>

						<li class="nav-item">
							<a href="/phylogenetic_tree/">
								<i class="fas fa-tree"></i>
								<p>Phylogenetic tree</p>
							</a>
						</li>

						<li class="nav-item">
							<a href="/CRE_network/">
								<i class="fas fa-table"></i>
								<p>CRE network</p>
							</a>
						</li>
						
						<li class="nav-item">
							<a href="/About_Contact/">
								<i class="fab fa-telegram"></i>
								<p>About & Contact</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/Disclaimer/">
								<i class="fas fa-bars"></i>
								<p>Disclaimer</p>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- End Sidebar -->

		
		<div class="main-panel">
			<div class="content">
				<div class="page-inner">
					<div class="page-header">
						<h4 class="page-title">PathoTracker</h4>
						<ul class="breadcrumbs">
							<li class="nav-home">
								<a href="#">
									<i class="flaticon-home"></i>
								</a>
							</li>
							<li class="separator">
								<i class="flaticon-right-arrow"></i>
							</li>
							<li class="nav-item">
								<a href="#">Home</a>
							</li>
							<li class="separator">
								<i class="flaticon-right-arrow"></i>
							</li>
							<li class="nav-item">
								<a href="#">PathoTracker</a>
							</li>
						</ul>
					</div>
					<div class="row">
						<div class="col">
							<!--
							<div class="card">
								<div class="card-header">
									<h4 class="card-title">Species identification ({{filename}})</h4>
								</div>
								
								<div class="card-body">
									<h4 class="mt-3 b-b1 pb-2 mb-4 fw-bold">Species</h4>
									<div class="pre-scrollable">
									<table class="table table-head-bg-primary mt-4" style="overflow-y:auto;overflow-x:auto; height:100px;" id="tab-species">
										<thead>
											<tr>
												<th scope="col">name</th><th scope="col">taxID</th><th scope="col">taxRank</th><th scope="col">genomeSize</th>
												<th scope="col">numReads</th><th scope="col">numUniqueReads</th><th scope="col">abundance</th>
											</tr>
										</thead>

										<tbody>
											<tr></tr>
										</tbody>
									</table>
									</div>
								</div>
								
							</div>
							-->

							<div class="card">
								<div class="card-header">
									<h4 class="card-title">PathoTracker ({{filename}})</h4>
								</div>
								<div class="card-body"  style="height:700px;">
									<h4 class="mt-3 b-b1 pb-2 mb-4 fw-bold">Isolate genotype</h4>
									<div class="pre-scrollable tableBody">
										<table class="table table-head-bg-primary mt-4" style="overflow-x:auto;overflow-y:auto;" id="tab-isolate" > <!---->
											<thead>
												<tr>
												<th scope="col" style="font-size:10px;">Isolate</th>
												<th scope="col" style="font-size:10px;">score all</th>
												<th scope="col" style="font-size:10px;">pan genome comparison</th>
												<th scope="col" style="font-size:10px;">score_identity</th>
												<th scope="col" style="font-size:10px;">score_avg</th>
												<th scope="col" style="font-size:10px;">pan genome count</th>
												<th scope="col" style="font-size:10px;">country</th>
												<th scope="col" style="font-size:10px;">state</th>
												<th scope="col" style="font-size:10px;">city</th>
												<th scope="col" style="font-size:10px;">collection_date</th>
												<th scope="col" style="font-size:10px;">cluster</th>
												<th scope="col" style="font-size:10px;">species</th>
												<th scope="col" style="font-size:10px;">species_match</th>
												<th scope="col" style="font-size:10px;">contig_count</th>
												<th scope="col" style="font-size:10px;">N50</th>
												<th scope="col" style="font-size:10px;">largest_contig</th>
												<th scope="col" style="font-size:10px;">ST</th>
												<th scope="col" style="font-size:10px;">virulence_score</th>
												<th scope="col" style="font-size:10px;">resistance_score</th>
												<th scope="col" style="font-size:10px;">num_resistance_classes</th>
												<th scope="col" style="font-size:10px;">num_resistance_genes</th>
												<th scope="col" style="font-size:10px;">Yersiniabactin</th>
												<th scope="col" style="font-size:10px;">YbST</th>
												<th scope="col" style="font-size:10px;">"col"ibactin</th>
												<th scope="col" style="font-size:10px;">CbST</th>
												<th scope="col" style="font-size:10px;">Aerobactin</th>
												<th scope="col" style="font-size:10px;">AbST</th>
												<th scope="col" style="font-size:10px;">Salmochelin</th>
												<th scope="col" style="font-size:10px;">SmST</th>
												<th scope="col" style="font-size:10px;">rmpA</th>
												<th scope="col" style="font-size:10px;">rmpA2</th>
												<th scope="col" style="font-size:10px;">wzi</th>
												<th scope="col" style="font-size:10px;">K_locus</th>
												<th scope="col" style="font-size:10px;">K_locus_problems</th>
												<th scope="col" style="font-size:10px;">K_locus_confidence</th>
												<th scope="col" style="font-size:10px;">K_locus_identity</th>
												<th scope="col" style="font-size:10px;">K_locus_missing_genes</th>
												<th scope="col" style="font-size:10px;">Chr_ST</th>
												<th scope="col" style="font-size:10px;">gapA</th>
												<th scope="col" style="font-size:10px;">infB</th>
												<th scope="col" style="font-size:10px;">mdh</th>
												<th scope="col" style="font-size:10px;">pgi</th>
												<th scope="col" style="font-size:10px;">phoE</th>
												<th scope="col" style="font-size:10px;">rpoB</th>
												<th scope="col" style="font-size:10px;">tonB</th>
												<th scope="col" style="font-size:10px;">ybtS</th>
												<th scope="col" style="font-size:10px;">ybtX</th>
												<th scope="col" style="font-size:10px;">ybtQ</th>
												<th scope="col" style="font-size:10px;">ybtP</th>
												<th scope="col" style="font-size:10px;">ybtA</th>
												<th scope="col" style="font-size:10px;">irp2</th>
												<th scope="col" style="font-size:10px;">irp1</th>
												<th scope="col" style="font-size:10px;">ybtU</th>
												<th scope="col" style="font-size:10px;">ybtT</th>
												<th scope="col" style="font-size:10px;">ybtE</th>
												<th scope="col" style="font-size:10px;">fyuA</th>
												<th scope="col" style="font-size:10px;">clbA</th>
												<th scope="col" style="font-size:10px;">clbB</th>
												<th scope="col" style="font-size:10px;">clbC</th>
												<th scope="col" style="font-size:10px;">clbD</th>
												<th scope="col" style="font-size:10px;">clbE</th>
												<th scope="col" style="font-size:10px;">clbF</th>
												<th scope="col" style="font-size:10px;">clbG</th>
												<th scope="col" style="font-size:10px;">clbH</th>
												<th scope="col" style="font-size:10px;">clbI</th>
												<th scope="col" style="font-size:10px;">clbL</th>
												<th scope="col" style="font-size:10px;">clbM</th>
												<th scope="col" style="font-size:10px;">clbN</th>
												<th scope="col" style="font-size:10px;">clbO</th>
												<th scope="col" style="font-size:10px;">clbP</th>
												<th scope="col" style="font-size:10px;">clbQ</th>
												<th scope="col" style="font-size:10px;">AGly</th>
												<th scope="col" style="font-size:10px;">COL</th>
												<th scope="col" style="font-size:10px;">Fcyn</th>
												<th scope="col" style="font-size:10px;">Flq</th>
												<th scope="col" style="font-size:10px;">Gly</th>
												<th scope="col" style="font-size:10px;">MLS</th>
												<th scope="col" style="font-size:10px;">Ntmdz</th>
												<th scope="col" style="font-size:10px;">Phe</th>
												<th scope="col" style="font-size:10px;">Rif</th>
												<th scope="col" style="font-size:10px;">Sul</th>
												<th scope="col" style="font-size:10px;">Tet</th>
												<th scope="col" style="font-size:10px;">Tmt</th>
												<th scope="col" style="font-size:10px;">Bla</th>
												<th scope="col" style="font-size:10px;">Bla_Carb</th>
												<th scope="col" style="font-size:10px;">Bla_ESBL</th>
												<th scope="col" style="font-size:10px;">Bla_ESBL_inhR</th>
												<th scope="col" style="font-size:10px;">Bla_broad</th>
												<th scope="col" style="font-size:10px;">Bla_broad_inhR</th>
												<th scope="col" style="font-size:10px;">MEM</th>
												<th scope="col" style="font-size:10px;">IPM</th>
												<th scope="col" style="font-size:10px;">ETP</th>
												<th scope="col" style="font-size:10px;">FOX</th>
												<th scope="col" style="font-size:10px;">FEP</th>
												<th scope="col" style="font-size:10px;">CAZ</th>
												<th scope="col" style="font-size:10px;">CAZ-AVI</th>
												<th scope="col" style="font-size:10px;">CLC</th>
												<th scope="col" style="font-size:10px;">CTX</th>
												<th scope="col" style="font-size:10px;">CTC</th>
												<th scope="col" style="font-size:10px;">CRO</th>
												<th scope="col" style="font-size:10px;">CSL</th>
												<th scope="col" style="font-size:10px;">TZP</th>
												<th scope="col" style="font-size:10px;">AMK</th>
												<th scope="col" style="font-size:10px;">CIP</th>
												<th scope="col" style="font-size:10px;">LVX</th>
												<th scope="col" style="font-size:10px;">MIN</th>
												<th scope="col" style="font-size:10px;">COL</th>
												<th scope="col" style="font-size:10px;">TGC</th>
												<th scope="col" style="font-size:10px;">CHL</th>
												<th scope="col" style="font-size:10px;">FOS</th>
												<th scope="col" style="font-size:10px;">ATM</th>
												<th scope="col" style="font-size:10px;">ATM-AVI</th>
											</tr>
											</thead>
										
											<tbody  style="overflow-x:auto; height:800px;">
												<tr></tr>
											</tbody>							
										
										</table>
									</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header">
									<h4 class="card-title">PathoTracker</h4>
								</div>
								<div class="card-body">
									<h4 class="mt-3 b-b1 pb-2 mb-4 fw-bold">Resistance genes</h4>
									<table class="table table-head-bg-primary mt-4" >
										<thead>
											<tr>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Gene</th>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Identity</th>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Coverage</th>
											</tr>
										</thead>
									</table>
									<div class="pre-scrollable tableBody">
										<table class="table" style="margin-bottom: 0px;">
											<tbody style="overflow-y:scroll; height:100px;" id="tab-res">
												<tr></tr>
											</tbody>
                                    	</table>
									</div>

									<h4 class="mt-5 pb-3 mb-0 fw-bold">Virulence genes</h4>
									<table class="table table-head-bg-primary mt-4" >
										<thead>
											<tr>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Gene</th>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Identity</th>
												<th scope="col" style="width:33%;text-align:center;font-size:15px;">Coverage</th>
											</tr>
										</thead>
									</table>
									<div class="pre-scrollable tableBody">
										<table class="table" style="margin-bottom: 0px;">
											<tbody style="overflow-y:scroll; height:100px;" id="tab-vir">
												<tr></tr>
											</tbody>
                                    	</table>
									</div>
								</div>
							</div>
						</div>
					</div>

		</div>
	</div>

	<footer class="footer">
		<div class="container-fluid">
			<nav class="pull-left">
				<ul class="nav">
					<li class="nav-item">
						<a class="nav-link" href="https://www.pkuph.cn/">
							pkuph
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="https://www.pku.edu.cn/">
							pku
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="https://www.bjmu.edu.cn/">
							bjmu
						</a>
					</li>
					<li class="nav-item">
								<a class="nav-link" href="https://www.wanghuilab.net">
									huilab
								</a>
						</li>
					</ul>
				</nav>
			<div class="copyright ml-auto">
						Copyright 2023 Huilab, Department of Clinical Laboratory<br>Peking University People's Hospital, Beijing, China.
						<br>
						<!--<i class="fa fa-heart heart text-danger"></i>
						by <a href="https://www.wanghuilab.net"> Huilab </a>-->
			</div>				
		</div>
	</footer>
	</div>
		
	</div>
	
	<!--   Core JS Files   -->
	<script src="/statics/assets/js/core/jquery.3.2.1.min.js"></script>
	<script src="/statics/assets/js/core/popper.min.js"></script>
	<script src="/statics/assets/js/core/bootstrap.min.js"></script>
	<!-- jQuery UI -->
	<script src="/statics/assets/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
	<script src="/statics/assets/js/plugin/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js"></script>
	
	<!-- jQuery Scrollbar -->
	<script src="/statics/assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
	<!-- Atlantis JS -->
	<script src="/statics/assets/js/atlantis.min.js"></script>

	<script type="text/javascript">
	
		//function GetRequest() {
		//	var url = location.search; //获取url中"?"符后的字串
		//	var theRequest = new Object();
		//		if (url.indexOf("?") != -1) {
		//		var str = url.substr(1);
		//		strs = str.split("&");
		//		for(var i = 0; i < strs.length; i ++) {
		//		theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
		//		}
		//	}
		//	return theRequest;
		//}
		//function fill() {
		//	var filename = GetRequest();
		//	console.log(filename)
		//}
		
		
		//var form = new FormData();
		//form.append('filename', filename);
		//console.log(filename)
	
		//xhr.open('POST','/result/',true);
		//xhr.setRequestHeader('X-CSRFTOKEN','{{ request.COOKIES.csrftoken }}');   //Django CSRF
		//xhr.send(form); 
		
		//var filename = "{{filename}}"
		
		
		var filename = "{{filename}}"
		
		console.log("return reponse")
		var species = "{{species}}"
		
		//console.log(species)
		
		var arr=species.split("	");
		//console.log(arr);
		for (var i = 0; i < arr.length-1; i++) {
			var str = "<tr><td style=\"width:33%; font-size:10px;\" align=\"center\">";
			for (var j = 0; j < 7; j++){
				if (j == 0)
				{
					str = str + arr[i]
					i++;
					continue
				}
				str = str + "</td><td style=\"width:33%; font-size:10px;\" align=\"center\">" + arr[i]
				i++;
			}
			str = str + "</td></tr>";
			//console.log(str);
			$("#tab-species").append(str);
			i--;
		}

		var data = "{{html_data}}"
		var arr=data.split("	");
		//console.log(arr);
		for (var i = 0; i < arr.length-1; i++) {
			var str = "<tr><td  style=\"width:33%; font-size:10px;\" align=\"center\">";
			for (var j = 0; j < 112; j++){
				if (j == 0)
				{
					str = str + arr[i]
					i++;
					continue
				}
				str = str + "</td><td  style=\"width:33%; font-size:10px;\" align=\"center\">" + arr[i]
				i++;
			}
			str = str + "</td></tr>";
			//console.log(str);
			$("#tab-isolate").append(str);
			i--;
		}
		var data_res = "{{message_res}}"
		var arr=data_res.split(" ");
		var count_res = "{{count_res}}"
		count_res = Number(count_res)
		//console.log(count_res);
		for (var i = 0; i < count_res*4; i++) {
			var str = "<tr><td style=\"width:33%; font-size:10px;\" align=\"center\">";
			for (var j = 0; j < 3; j++){
				if (j == 0)
				{
					str = str + arr[i]
					i++;
					continue
				}
				str = str + "</td><td  style=\"width:33%; font-size:10px; \" align=\"center\">" + arr[i]
				i++;
			}

			str = str + "</td></tr>";
			//console.log(str);
			$("#tab-res").append(str);
		}

		var data_vir = "{{message_vir}}"
		var arr=data_vir.split(" ");
		var count_vir = "{{count_vir}}"
		count_vir = Number(count_vir)
		//console.log(count_vir);
		for (var i = 0; i < count_vir*4; i++) {
			var str = "<tr><td style=\"width:33%; font-size:10px; \" align=\"center\">";
			for (var j = 0; j < 3; j++){
				if (j == 0)
				{
					str = str + arr[i]
					i++;
					continue
				}
				str = str + "</td><td  style=\"width:33%; font-size:10px; \" align=\"center\">" + arr[i]
				i++;
			}

			str = str + "</td></tr>";
			//console.log(str);
			$("#tab-vir").append(str);
		}
	</script>

</body>
</html>